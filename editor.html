<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeX Editor Libre</title>
    <script type="module" src="firebase.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <style>
        :root {
            
            --text-color: #ffffff;
            --editor-bg: #2c2c2c;
            --output-bg: #3c3c3c;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .editor-container {
            background-color: var(--editor-bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #editor {
            width: 100%;
            height: 200px;
            border: 2px solid #ff69b4;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.6;
        }

        .font-controls {
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            flex-wrap: nowrap;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .gradient-button {
            background: linear-gradient(45deg, #ffd700, #ff69b4);
            border: none;
            color: #ffffff;
            padding: 10px 15px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 0 5px;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 25px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            white-space: nowrap;
        }

        .gradient-button:hover {
            background: linear-gradient(45deg, #ff69b4, #ffd700);
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        #language {
            background: linear-gradient(45deg, #ffd700, #ff69b4);
            border: none;
            color: #ffffff;
            padding: 10px 15px;
            font-size: 14px;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        #output-container {
            background-color: var(--output-bg);
            border: 2px solid #ffd700;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #output {
            font-family: 'Courier New', Courier, monospace;
            white-space: pre-wrap;
            color: var(--text-color);
            font-size: 14px;
        }

        #ai-suggestions {
            margin-top: 20px;
            background-color: var(--editor-bg);
            border: 2px solid #ffd700;
            border-radius: 10px;
            padding: 10px;
        }

        .suggestion-button {
            background: linear-gradient(45deg, #4a90e2, #50e3c2);
            border: none;
            color: #ffffff;
            padding: 5px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px;
            margin: 5px;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .suggestion-button:hover {
            background: linear-gradient(45deg, #50e3c2, #4a90e2);
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .font-controls {
                flex-wrap: nowrap;
                justify-content: flex-start;
                overflow-x: auto;
            }

            .gradient-button, #language {
                flex: 0 0 auto;
            }
        }
    </style>
 <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
   
 <link href="navbarlogicacss.css" rel="stylesheet">
</head>
<body>
  <div id="navbar-container"></div>
    <div class="container-fluid mt-4">
        <div class="row">
            <div class="col-md-6">
                <div class="editor-container">
                    <div class="font-controls">
                        <button id="increase-font" class="gradient-button"><i class="fas fa-plus"></i> A+</button>
                        <button id="decrease-font" class="gradient-button"><i class="fas fa-minus"></i> A-</button>
                        <button id="clear-content" class="gradient-button"><i class="fas fa-eraser"></i> Borrar</button>
                        <select id="language" class="gradient-button">
                            <option value="javascript">JavaScript</option>
                            <option value="python">Python</option>
                            <option value="c_cpp">C++</option>
                        </select>
                        <button id="run-button" class="gradient-button">▶️ Ejecutar</button>
                    </div>
                    <div id="editor"></div>
                    <div id="ai-suggestions"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div id="output-container">
                    <pre id="output"></pre>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
          const editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.session.setMode("ace/mode/javascript");
        async function executeCode(code, language) {
    const apiUrl = 'https://emkc.org/api/v2/piston/execute';

    const payload = {
        language: mapLanguage(language),
        version: '*',  // Usa la última versión disponible del lenguaje
        files: [
            {
                name: 'main',
                content: code
            }
        ],
        stdin: '',
        args: [],
        compile_timeout: 10000,
        run_timeout: 3000,
        compile_memory_limit: -1,
        run_memory_limit: -1
    };

    try {
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(payload)
        });

        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
        }

        const result = await response.json();
        return result.run.output || 'No hay salida';
    } catch (error) {
        console.error('Error al ejecutar el código:', error);
        throw error;
    }
}
        function mapLanguage(language) {
    const languageMap = {
        'javascript': 'javascript',
        'python': 'python3',
        'c_cpp': 'c++'
    };
    return languageMap[language] || 'javascript';
}

        document.getElementById('increase-font').addEventListener('click', () => {
            let fontSize = parseInt(editor.getFontSize(), 10);
            editor.setFontSize(fontSize + 1);
        });

        document.getElementById('decrease-font').addEventListener('click', () => {
            let fontSize = parseInt(editor.getFontSize(), 10);
            editor.setFontSize(fontSize - 1);
        });

        document.getElementById('clear-content').addEventListener('click', () => {
            editor.setValue('');
        });

        document.getElementById('language').addEventListener('change', (e) => {
            const lang = e.target.value;
            editor.session.setMode(`ace/mode/${lang}`);
        });

        document.getElementById('run-button').addEventListener('click', async () => {
    const code = editor.getValue();
    const language = document.getElementById('language').value;
    const output = document.getElementById('output');
    output.textContent = 'Ejecutando código...';

    try {
        const result = await executeCode(code, language);
        output.textContent = result;
    } catch (error) {
        console.error('Error al ejecutar el código:', error);
        output.textContent = `Error: ${error.message}`;
    }
});
        // Algoritmo sugerencias 
        const codePatterns = {
            'javascript': [
                { trigger: 'if', snippet: 'if (condition) {\n    \n}' },
                { trigger: 'for', snippet: 'for (let i = 0; i < array.length; i++) {\n    \n}' },
                { trigger: 'function', snippet: 'function functionName(params) {\n    \n}' },
                { trigger: 'class', snippet: 'class ClassName {\n    constructor() {\n        \n    }\n}' },
                { trigger: 'fetch', snippet: 'fetch(url)\n    .then(response => response.json())\n    .then(data => {\n        \n    })\n    .catch(error => {\n        console.error(\'Error:\', error);\n    });' },
            ],
            'python': [
                { trigger: 'if', snippet: 'if condition:\n    ' },
                { trigger: 'for', snippet: 'for item in iterable:\n    ' },
                { trigger: 'def', snippet: 'def function_name(parameters):\n    ' },
                { trigger: 'class', snippet: 'class ClassName:\n    def __init__(self):\n        ' },
                { trigger: 'with', snippet: 'with open(\'filename.txt\', \'r\') as file:\n    content = file.read()\n    ' },
            ],
            'c_cpp': [
                { trigger: 'if', snippet: 'if (condition) {\n    \n}' },
                { trigger: 'for', snippet: 'for (int i = 0; i < n; i++) {\n    \n}' },
                { trigger: 'while', snippet: 'while (condition) {\n    \n}' },
                { trigger: 'class', snippet: 'class ClassName {\npublic:\n    ClassName() {\n        \n    }\n};' },
                { trigger: 'switch', snippet: 'switch (variable) {\n    case value1:\n        // code\n        break;\n    case value2:\n        // code\n        break;\n    default:\n        // code\n}' },
            ]
        };

        editor.session.on('change', function() {
            const currentLanguage = document.getElementById('language').value;
            const cursorPosition = editor.getCursorPosition();
            const currentLine = editor.session.getLine(cursorPosition.row);
            const currentWord = getCurrentWord(currentLine, cursorPosition.column);

            const suggestions = codePatterns[currentLanguage].filter(pattern => 
                pattern.trigger.startsWith(currentWord) && pattern.trigger !== currentWord
            );

            displaySuggestions(suggestions);
        });

        function getCurrentWord(line, column) {
            const wordRegex = /[a-zA-Z]+/g;
            let match;
            while ((match = wordRegex.exec(line)) !== null) {
                if (match.index <= column && column <= match.index + match[0].length) {
                    return match[0].slice(0, column - match.index);
                }
            }
            return '';
        }

        function displaySuggestions(suggestions) {
            const aiSuggestions = document.getElementById('ai-suggestions');
            aiSuggestions.innerHTML = '';
            if (suggestions.length > 0) {
                aiSuggestions.innerHTML = '<strong>Sugerencias codigo:</strong><br>';
                suggestions.forEach(suggestion => {
                    const button = document.createElement('button');
                    button.textContent = suggestion.trigger;
                    button.className = 'suggestion-button';
                    button.onclick = () => insertSnippet(suggestion.snippet);
                    aiSuggestions.appendChild(button);
                });
            }
        }

        function insertSnippet(snippet) {
            editor.insert(snippet);
            editor.focus();
        }
    </script>
    <script type="module">
      import { initializeNavbar } from './navbarlogica.js';
      initializeNavbar();</script>
</body>
</html>